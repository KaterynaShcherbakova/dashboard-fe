"use strict";(self["webpackChunktest_task_app"]=self["webpackChunktest_task_app"]||[]).push([[979],{979:function(t,e,i){i.r(e),i.d(e,{default:function(){return z}});var s=i(641);function r(t,e,i,r,n,a){const d=(0,s.g2)("Workspace");return(0,s.uX)(),(0,s.Wv)(d)}var n=i(751),a=i(33);const d=(0,s.Lk)("h1",null,"Trading desk",-1),l={class:"trading-desk-wrapper",ref:"tradingDeskWrapper"},o=["onClick"];function h(t,e,i,r,h,u){const g=(0,s.g2)("Tile");return(0,s.uX)(),(0,s.CE)(s.FK,null,[d,(0,s.Lk)("div",l,[(0,s.Lk)("div",{class:"trading-desk",ref:"tradingDesk",onDragover:e[0]||(e[0]=(0,n.D$)((()=>{}),["prevent"])),onDrop:e[1]||(e[1]=t=>u.handleDrop(t))},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(h.tiles,(t=>((0,s.uX)(),(0,s.CE)(s.FK,{key:t.id},[t.deleted?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"return-tile-box",style:(0,a.Tr)(u.getReturnTileBoxStyle(t)),onClick:e=>u.returnTileById(t.id)},(0,a.v_)(u.getReturnTileBoxText(t)),13,o)):((0,s.uX)(),(0,s.Wv)(g,{key:1,data:t,onDragStart:e=>{u.bringToFront(t),u.handleDragStart(t,e)},onDragEnd:e=>u.handleDragEnd(t),onClick:e=>u.bringToFront(t),onDelete:e=>u.deleteTileById(t.id)},null,8,["data","onDragStart","onDragEnd","onClick","onDelete"]))],64)))),128))],544)],512)],64)}var u=i(775);const g={class:"tile-header"},c={class:"tile-title"};function T(t,e,i,r,d,l){return(0,s.uX)(),(0,s.CE)("div",{class:"tile",style:(0,a.Tr)(l.getTileStyle()),draggable:"true",onDragstart:e[2]||(e[2]=t=>l.handleDragStart(t)),onDragover:e[3]||(e[3]=(0,n.D$)((()=>{}),["prevent"])),onDragend:e[4]||(e[4]=t=>l.handleDragEnd())},[(0,s.Lk)("header",g,[(0,s.Lk)("h4",c,(0,a.v_)(l.getTileTitle()),1),(0,s.Lk)("button",{class:"tile-button",onClick:e[0]||(e[0]=e=>t.$emit("delete"))},"delete")]),(0,s.Lk)("div",{class:"tile-resize-handle",onMousedown:e[1]||(e[1]=t=>l.initResize(t))},null,32)],36)}var p={data(){return{resizeXStartPos:0,resizeYStartPos:0,startTileHeight:0,startTileWidth:0,isResizing:!1}},props:{data:{type:Object,required:!0}},methods:{getTileStyle(){return{left:`${this.data.x}px`,top:`${this.data.y}px`,width:`${this.data.width}px`,height:`${this.data.height}px`,zIndex:this.data.zIndex}},valueStickedToGrid(t){return Math.round(t/u.Ey)*u.Ey},getTileTitle(){return`Tile ${this.data.id}`},handleDragStart(t){this.isResizing?t.preventDefault():this.$emit("drag-start",t)},handleDragEnd(){this.$emit("drag-end")},initResize(t){this.isResizing=!0,this.resizeXStartPos=t.clientX,this.resizeYStartPos=t.clientY,this.startTileHeight=this.data.height,this.startTileWidth=this.data.width,window.addEventListener("mousemove",this.handleResize),window.addEventListener("mouseup",this.stopResize)},handleResize(t){const e=t.clientX-this.resizeXStartPos,i=t.clientY-this.resizeYStartPos,s=Math.max(u.l_,this.startTileWidth+e),r=Math.max(u.YZ,this.startTileHeight+i);this.data.width=this.valueStickedToGrid(s),this.data.height=this.valueStickedToGrid(r)},stopResize(){window.removeEventListener("mousemove",this.handleResize),window.removeEventListener("mouseup",this.stopResize),this.isResizing=!1,this.$emit("stop-resize")}}},f=i(262);const k=(0,f.A)(p,[["render",T]]);var v=k,x={components:{Tile:v},data(){return{tiles:[],topZIndex:5,nextId:0,currentTile:null,dragOffsetX:0,dragOffsetY:0}},created(){this.loadTiles()},methods:{addNewItem(t,e){const i={id:this.nextId++,x:t,y:e,width:u.Ui,height:u.Pb,zIndex:0,deleted:!1};return i},getReturnTileBoxStyle(t){return{left:`${t.x}px`,top:`${t.y}px`,zIndex:t.zIndex}},defaultTiles(){return[this.addNewItem(10,10),this.addNewItem(320,10),this.addNewItem(630,10),this.addNewItem(10,120),this.addNewItem(320,120)]},getReturnTileBoxText(t){return`Return tile ${t.id} to trading desk`},getTradingDeskWidth(){const t=this.$refs.tradingDesk;return t?t.offsetWidth:600},getTradingDeskHeight(){const t=this.$refs.tradingDesk;return t?t.offsetHeight:600},bringToFront(t){t.zIndex=++this.topZIndex,this.saveTiles()},returnTileById(t){this.tiles=this.tiles.map((e=>(e.id===t&&(e.deleted=!1,e.height=u.Pb,e.width=u.Ui,e.x=(this.getTradingDeskWidth()-u.Ui)/2,e.y=(this.getTradingDeskHeight()-u.Pb)/2),e)))},deleteTileById(t){this.tiles=this.tiles.map((e=>(e.id===t&&(e.deleted=!0),e)))},valueStickedToGrid(t){return Math.round(t/u.Ey)*u.Ey},handleDrop(t){if(this.currentTile){const e=this.$refs.tradingDeskWrapper,i=t.clientX+e.scrollLeft-this.dragOffsetX,s=t.clientY+e.scrollTop-this.dragOffsetY;this.currentTile.x=this.valueStickedToGrid(i),this.currentTile.y=this.valueStickedToGrid(s),this.saveTiles()}},handleDragStart(t,e){const i=this.$refs.tradingDeskWrapper;this.dragOffsetX=e.clientX+i.scrollLeft-t.x,this.dragOffsetY=e.clientY+i.scrollTop-t.y,this.currentTile=t},handleDragEnd(){this.currentTile=null},loadTiles(){const t=localStorage.getItem("tiles"),e=localStorage.getItem("next_id"),i=localStorage.getItem("top-z-index");this.nextId=Number(e)||0,this.topZIndex=Number(i)||6,this.tiles=t?JSON.parse(t):this.defaultTiles()},saveTiles(){localStorage.setItem("tiles",JSON.stringify(this.tiles)),localStorage.setItem("next_id",this.nextId.toString()),localStorage.setItem("top-z-index",this.topZIndex.toString())}}};const m=(0,f.A)(x,[["render",h]]);var D=m,S={components:{Workspace:D}};const I=(0,f.A)(S,[["render",r]]);var z=I},775:function(t,e,i){i.d(e,{Ey:function(){return s},P9:function(){return h},Pb:function(){return d},Tb:function(){return l},Ui:function(){return a},YZ:function(){return n},l_:function(){return r},ut:function(){return o}});const s=10,r=20,n=20,a=300,d=100,l="wss://ws.blockchain.info/inv",o=1e8,h={start:"Start",stop:"Stop",reset:"Reset"}}}]);
//# sourceMappingURL=979.720e5f84.js.map